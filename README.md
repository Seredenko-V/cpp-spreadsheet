# Электронная таблица
Дипломный проект в рамках [курса](https://practicum.yandex.ru/cpp/?from=catalog) Яндекс Практикума.  
Код лексического и синтаксического анализаторов, а также код для обхода дерева разбора на С++ генерируется при помощи
[ANTLR](https://www.antlr.org/).  

## Системные требования
* CMake 3.8
* GCC 10.0
* C++17
* ANTLR 4.11.0

## Настройка окружения
* Руководство по установке ANTLR4 можно найти [здесь](https://github.com/antlr/antlr4/blob/master/doc/getting-started.md). 
Если возникают трудности при работе в windows, можно также попробовать 
[это руководство](https://www.notion.so/ANTLR4-windows-0addba24c5d74810a964eac8420f272a?pvs=4).

* Для компиляции кода понадобится библиотека ANTLR4 C++ Runtime. Скачайте архив `antlr4-cpp-runtime*.zip` 
из раздела [Download](https://www.antlr.org/download.html), расположенный в **C++ Target**.

* Далее необходимо собрать проект согласно структуре
```
spreadsheet/
 ├── antlr4_runtime/
 │   └── Содержимое архива antlr4-cpp-runtime*.zip.
 ├── build/
 ├── antlr-4.11.1-complete.jar
 ├── CMakeLists.txt
 ├── FindANTLR.cmake
 ├── Formula.g4
 ├── Остальные файлы проекта
 └── ...
```
**Обратите внимание**, что версия архива `antlr-4.11.1-complete.jar` может отличаться от актуальной. 
 В CMakeLists.txt замените версию JAR-файла на актуальную.

## Функционал
### Ячейки
Существует три типа ячеек: формульная, текстовая и пустая. В процессе работы тип ячейки может изменяться динамически, в зависимости от 
вновь установленного содержимого.  
Все ячейки имеют следующие методы:
1. `void Set(std::string text)` - установить содержимое ячейки.
2. `void Clear()` -  очистить содержимое ячейки. Вызов этого метода равносилен созданию пустой ячейки.
3. `Value GetValue() const` - получить значение ячейки. Значениями могут являться `std::string`, `double` или `FormulaError`.
4. `std::string GetText() const` - получить текстовое содержимое ячейки.

#### Формульная
Ячейка является формульной, если её текст начинается со знака `=`. Пробелы перед знаком `=` **не** игнорируются, то есть ячейка, 
заданная текстом: `" =1+2"`, не считается формульной. Содержимое после знака `=` является выражением формулы. При этом текст, 
который содержит только знак `=`, формулой не считается, а считается текстом.

#### Текстовая
Все ячейки, кроме формульных, трактуются как текстовые. Обычно для них результат метода `GetValue()` совпадает с результатом 
метода `GetText()`. Кроме случая, когда текст начинается с символа `'` (апостроф). Тогда в `GetValue()` этот символ отсутствует. 
Это нужно, если мы хотим начать текст со знака `=`, но не хотим, чтобы он интерпретировался как формула.  
Например, ячейка задана строкой `"'=1+2"`, тогда
* `GetText()` от неё `"'=1+2"`;
* `GetValue()` от неё `"=1+2"`.

#### Пустая
Создаётся при передаче в метод `Set(std::string text)` пустой строки. Также может быть получена путём вызова метода `Clear()` 
от непустой ячейки. Методы `GetText()` и `GetValue()` от неё возвращают пустые строки.

### Таблица
